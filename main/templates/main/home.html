{% extends 'main/base.html' %}
{% load static %}

{% block title %}Home - Skill Swap{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 py-12">

  <h1 class="text-4xl font-bold text-center text-gray-800 mb-10">Swap Skills with Others</h1>

  <!-- Search Bar & Filters -->
  <div class="flex flex-col md:flex-row justify-center items-center gap-4 mb-10">
    <form method="GET" class="flex w-full max-w-xl gap-2">
      <input type="text" name="search" placeholder="Search skills"
             value="{{ request.GET.search }}"
             class="flex-1 px-4 py-2 rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-teal-400">
      <button type="submit"
              class="bg-teal-600 text-white px-5 py-2 rounded-lg shadow hover:bg-teal-700 transition">
        Search
      </button>
    </form>

    <form method="GET">
      <select name="availability"
              class="px-4 py-2 rounded-lg border shadow-sm focus:outline-none focus:ring-2 focus:ring-teal-400">
        <option value="">Availability</option>
        <option value="Weekends" {% if request.GET.availability == "Weekends" %}selected{% endif %}>Weekends</option>
        <option value="Evenings" {% if request.GET.availability == "Evenings" %}selected{% endif %}>Evenings</option>
        <option value="Mornings" {% if request.GET.availability == "Mornings" %}selected{% endif %}>Mornings</option>
      </select>
    </form>
  </div>

  <!-- User Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
    {% for user in users %}
    <div class="bg-white p-6 rounded-2xl shadow-md text-center">
      <img src="{% static 'main/images/avatar_placeholder.png' %}" alt="Avatar"
           class="w-20 h-20 mx-auto rounded-full border-4 border-teal-500 mb-4">
      <h2 class="text-xl font-semibold text-gray-800 mb-1">{{ user.name }}</h2>
      <p class="text-sm text-gray-500 mb-2">{{ user.availability }}</p>

      <div class="flex flex-wrap justify-center gap-2 mb-2">
        {% for skill in user.skills_offered %}
        <span class="text-xs px-3 py-1 bg-teal-100 text-teal-800 rounded-full">Skills offered</span>
        {% endfor %}
      </div>

      <div class="flex flex-wrap justify-center gap-2 mb-4">
        {% for skill in user.skills_wanted %}
        <span class="text-xs px-3 py-1 bg-cyan-100 text-cyan-800 rounded-full">Skills wanted</span>
        {% endfor %}
      </div>

      <button class="bg-teal-600 text-white text-sm px-4 py-1.5 rounded-md hover:bg-teal-700 transition">
        Request
      </button>
    </div>
    {% empty %}
    <div class="col-span-full text-center text-gray-500 text-lg">No users found.</div>
    {% endfor %}
  </div>

  <!-- Pagination -->
  {% if users.has_other_pages %}
  <div class="flex justify-center mt-10">
    <nav class="inline-flex items-center bg-white shadow-sm rounded-lg">
      {% if users.has_previous %}
      <a href="?page={{ users.previous_page_number }}&search={{ request.GET.search }}&availability={{ request.GET.availability }}"
         class="px-4 py-2 text-sm border-r rounded-l-lg hover:bg-gray-100">←</a>
      {% else %}
      <span class="px-4 py-2 text-sm text-gray-400 border-r rounded-l-lg">←</span>
      {% endif %}

      <span class="px-4 py-2 text-sm">{{ users.number }}</span>

      {% if users.has_next %}
      <a href="?page={{ users.next_page_number }}&search={{ request.GET.search }}&availability={{ request.GET.availability }}"
         class="px-4 py-2 text-sm border-l rounded-r-lg hover:bg-gray-100">→</a>
      {% else %}
      <span class="px-4 py-2 text-sm text-gray-400 border-l rounded-r-lg">→</span>
      {% endif %}
    </nav>
  </div>
  {% endif %}
</div>
{% endblock %}
